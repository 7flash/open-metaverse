{"id":"RXVx","dependencies":[{"name":"/Users/mikelun/Work/OpenMetaverse/package.json","includedInParent":true,"mtime":1646878149302}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.initiateAudio=t,exports.removePeer=i;var e,n,o={iceServers:[{urls:\"stun:openrelay.metered.ca:80\"},{urls:\"turn:openrelay.metered.ca:80\",username:\"openrelayproject\",credential:\"openrelayproject\"},{urls:\"turn:openrelay.metered.ca:443\",username:\"openrelayproject\",credential:\"openrelayproject\"},{urls:\"turn:openrelay.metered.ca:443?transport=tcp\",username:\"openrelayproject\",credential:\"openrelayproject\"}]};function t(o,t){e=t,(n=o).on(\"initReceive\",function(e){console.log(\"INIT RECEIVE \"+e),r(e,!1),n.emit(\"initSend\",e)}),n.on(\"initSend\",function(e){console.log(\"INIT SEND \"+e),r(e,!0)}),n.on(\"removePeer\",function(e){console.log(\"removing peer \"+e),i(e)}),n.on(\"signal\",function(n){e[n.socket_id].signal(n.signal)})}function r(t,r,i){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(i){var a=i;console.log(\"EOO\"+a),e[t]=new SimplePeer({initiator:r,stream:a,config:o}),e[t].on(\"signal\",function(e){n.emit(\"signal\",{signal:e,socket_id:t})}),e[t].on(\"stream\",function(e){console.log(\"Was here\");var n=document.createElement(\"video\");n.srcObject=e,n.id=t,n.playsinline=!1,n.autoplay=!0,n.className=\"vid\",document.body.appendChild(n)}),window.toggleMute=function(){for(var e in console.log(\"Microphone has been toggled\"),a.getAudioTracks())a.getAudioTracks()[e].enabled=!a.getAudioTracks()[e].enabled,muteButton.innerText=a.getAudioTracks()[e].enabled?\"Unmuted\":\"Muted\"}})}function i(n){var o=document.getElementById(n);o&&(o.srcObject.getTracks().forEach(function(e){e.stop()}),o.srcObject=null,o.parentNode.removeChild(o));e[n]&&e[n].destroy(),delete e[n]}"},"sourceMaps":{"js":{"mappings":[{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":0}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":13}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":20}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":35}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":43}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":56}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":57}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":64}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":68}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":76}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":90}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":92}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":100}},{"source":"js/audioSocket.js","original":{"line":121,"column":1},"generated":{"line":1,"column":111}},{"source":"js/audioSocket.js","original":{"line":5,"column":1},"generated":{"line":1,"column":113}},{"source":"js/audioSocket.js","name":"peers","original":{"line":29,"column":4},"generated":{"line":1,"column":117}},{"source":"js/audioSocket.js","name":"socket","original":{"line":30,"column":4},"generated":{"line":1,"column":119}},{"source":"js/audioSocket.js","name":"configuration","original":{"line":5,"column":7},"generated":{"line":1,"column":121}},{"source":"js/audioSocket.js","original":{"line":5,"column":23},"generated":{"line":1,"column":123}},{"source":"js/audioSocket.js","original":{"line":7,"column":18},"generated":{"line":1,"column":124}},{"source":"js/audioSocket.js","original":{"line":7,"column":18},"generated":{"line":1,"column":135}},{"source":"js/audioSocket.js","original":{"line":8,"column":4},"generated":{"line":1,"column":136}},{"source":"js/audioSocket.js","name":"urls","original":{"line":9,"column":6},"generated":{"line":1,"column":137}},{"source":"js/audioSocket.js","original":{"line":9,"column":12},"generated":{"line":1,"column":142}},{"source":"js/audioSocket.js","original":{"line":11,"column":4},"generated":{"line":1,"column":174}},{"source":"js/audioSocket.js","name":"urls","original":{"line":12,"column":6},"generated":{"line":1,"column":175}},{"source":"js/audioSocket.js","original":{"line":12,"column":12},"generated":{"line":1,"column":180}},{"source":"js/audioSocket.js","name":"username","original":{"line":13,"column":6},"generated":{"line":1,"column":211}},{"source":"js/audioSocket.js","original":{"line":13,"column":16},"generated":{"line":1,"column":220}},{"source":"js/audioSocket.js","name":"credential","original":{"line":14,"column":6},"generated":{"line":1,"column":239}},{"source":"js/audioSocket.js","original":{"line":14,"column":18},"generated":{"line":1,"column":250}},{"source":"js/audioSocket.js","original":{"line":16,"column":4},"generated":{"line":1,"column":270}},{"source":"js/audioSocket.js","name":"urls","original":{"line":17,"column":6},"generated":{"line":1,"column":271}},{"source":"js/audioSocket.js","original":{"line":17,"column":12},"generated":{"line":1,"column":276}},{"source":"js/audioSocket.js","name":"username","original":{"line":18,"column":6},"generated":{"line":1,"column":308}},{"source":"js/audioSocket.js","original":{"line":18,"column":16},"generated":{"line":1,"column":317}},{"source":"js/audioSocket.js","name":"credential","original":{"line":19,"column":6},"generated":{"line":1,"column":336}},{"source":"js/audioSocket.js","original":{"line":19,"column":18},"generated":{"line":1,"column":347}},{"source":"js/audioSocket.js","original":{"line":21,"column":4},"generated":{"line":1,"column":367}},{"source":"js/audioSocket.js","name":"urls","original":{"line":22,"column":6},"generated":{"line":1,"column":368}},{"source":"js/audioSocket.js","original":{"line":22,"column":12},"generated":{"line":1,"column":373}},{"source":"js/audioSocket.js","name":"username","original":{"line":23,"column":6},"generated":{"line":1,"column":419}},{"source":"js/audioSocket.js","original":{"line":23,"column":16},"generated":{"line":1,"column":428}},{"source":"js/audioSocket.js","name":"credential","original":{"line":24,"column":6},"generated":{"line":1,"column":447}},{"source":"js/audioSocket.js","original":{"line":24,"column":18},"generated":{"line":1,"column":458}},{"source":"js/audioSocket.js","original":{"line":32,"column":7},"generated":{"line":1,"column":480}},{"source":"js/audioSocket.js","name":"initiateAudio","original":{"line":32,"column":16},"generated":{"line":1,"column":489}},{"source":"js/audioSocket.js","name":"_socket","original":{"line":32,"column":30},"generated":{"line":1,"column":491}},{"source":"js/audioSocket.js","name":"_peers","original":{"line":32,"column":39},"generated":{"line":1,"column":493}},{"source":"js/audioSocket.js","name":"peers","original":{"line":33,"column":4},"generated":{"line":1,"column":496}},{"source":"js/audioSocket.js","name":"_peers","original":{"line":33,"column":12},"generated":{"line":1,"column":498}},{"source":"js/audioSocket.js","name":"socket","original":{"line":34,"column":4},"generated":{"line":1,"column":501}},{"source":"js/audioSocket.js","name":"_socket","original":{"line":34,"column":13},"generated":{"line":1,"column":503}},{"source":"js/audioSocket.js","name":"on","original":{"line":35,"column":11},"generated":{"line":1,"column":506}},{"source":"js/audioSocket.js","original":{"line":35,"column":14},"generated":{"line":1,"column":509}},{"source":"js/audioSocket.js","original":{"line":35,"column":29},"generated":{"line":1,"column":523}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":35,"column":29},"generated":{"line":1,"column":532}},{"source":"js/audioSocket.js","name":"console","original":{"line":36,"column":8},"generated":{"line":1,"column":535}},{"source":"js/audioSocket.js","name":"log","original":{"line":36,"column":16},"generated":{"line":1,"column":543}},{"source":"js/audioSocket.js","original":{"line":36,"column":20},"generated":{"line":1,"column":547}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":36,"column":38},"generated":{"line":1,"column":563}},{"source":"js/audioSocket.js","name":"addPeer","original":{"line":37,"column":8},"generated":{"line":1,"column":566}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":37,"column":16},"generated":{"line":1,"column":568}},{"source":"js/audioSocket.js","original":{"line":37,"column":27},"generated":{"line":1,"column":571}},{"source":"js/audioSocket.js","name":"socket","original":{"line":39,"column":8},"generated":{"line":1,"column":574}},{"source":"js/audioSocket.js","name":"emit","original":{"line":39,"column":15},"generated":{"line":1,"column":576}},{"source":"js/audioSocket.js","original":{"line":39,"column":20},"generated":{"line":1,"column":581}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":39,"column":32},"generated":{"line":1,"column":592}},{"source":"js/audioSocket.js","name":"socket","original":{"line":42,"column":4},"generated":{"line":1,"column":597}},{"source":"js/audioSocket.js","name":"on","original":{"line":42,"column":11},"generated":{"line":1,"column":599}},{"source":"js/audioSocket.js","original":{"line":42,"column":14},"generated":{"line":1,"column":602}},{"source":"js/audioSocket.js","original":{"line":42,"column":26},"generated":{"line":1,"column":613}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":42,"column":26},"generated":{"line":1,"column":622}},{"source":"js/audioSocket.js","name":"console","original":{"line":43,"column":8},"generated":{"line":1,"column":625}},{"source":"js/audioSocket.js","name":"log","original":{"line":43,"column":16},"generated":{"line":1,"column":633}},{"source":"js/audioSocket.js","original":{"line":43,"column":20},"generated":{"line":1,"column":637}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":43,"column":35},"generated":{"line":1,"column":650}},{"source":"js/audioSocket.js","name":"addPeer","original":{"line":44,"column":8},"generated":{"line":1,"column":653}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":44,"column":16},"generated":{"line":1,"column":655}},{"source":"js/audioSocket.js","original":{"line":44,"column":27},"generated":{"line":1,"column":658}},{"source":"js/audioSocket.js","name":"socket","original":{"line":47,"column":4},"generated":{"line":1,"column":663}},{"source":"js/audioSocket.js","name":"on","original":{"line":47,"column":11},"generated":{"line":1,"column":665}},{"source":"js/audioSocket.js","original":{"line":47,"column":14},"generated":{"line":1,"column":668}},{"source":"js/audioSocket.js","original":{"line":47,"column":28},"generated":{"line":1,"column":681}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":47,"column":28},"generated":{"line":1,"column":690}},{"source":"js/audioSocket.js","name":"console","original":{"line":48,"column":8},"generated":{"line":1,"column":693}},{"source":"js/audioSocket.js","name":"log","original":{"line":48,"column":16},"generated":{"line":1,"column":701}},{"source":"js/audioSocket.js","original":{"line":48,"column":20},"generated":{"line":1,"column":705}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":48,"column":39},"generated":{"line":1,"column":722}},{"source":"js/audioSocket.js","name":"removePeer","original":{"line":49,"column":8},"generated":{"line":1,"column":725}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":49,"column":19},"generated":{"line":1,"column":727}},{"source":"js/audioSocket.js","name":"socket","original":{"line":52,"column":4},"generated":{"line":1,"column":732}},{"source":"js/audioSocket.js","name":"on","original":{"line":52,"column":11},"generated":{"line":1,"column":734}},{"source":"js/audioSocket.js","original":{"line":52,"column":14},"generated":{"line":1,"column":737}},{"source":"js/audioSocket.js","original":{"line":52,"column":24},"generated":{"line":1,"column":746}},{"source":"js/audioSocket.js","name":"data","original":{"line":52,"column":24},"generated":{"line":1,"column":755}},{"source":"js/audioSocket.js","name":"peers","original":{"line":53,"column":8},"generated":{"line":1,"column":758}},{"source":"js/audioSocket.js","name":"data","original":{"line":53,"column":14},"generated":{"line":1,"column":760}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":53,"column":19},"generated":{"line":1,"column":762}},{"source":"js/audioSocket.js","name":"signal","original":{"line":53,"column":30},"generated":{"line":1,"column":773}},{"source":"js/audioSocket.js","name":"data","original":{"line":53,"column":37},"generated":{"line":1,"column":780}},{"source":"js/audioSocket.js","name":"signal","original":{"line":53,"column":42},"generated":{"line":1,"column":782}},{"source":"js/audioSocket.js","original":{"line":57,"column":0},"generated":{"line":1,"column":792}},{"source":"js/audioSocket.js","name":"addPeer","original":{"line":57,"column":9},"generated":{"line":1,"column":801}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":57,"column":17},"generated":{"line":1,"column":803}},{"source":"js/audioSocket.js","name":"am_initiator","original":{"line":57,"column":28},"generated":{"line":1,"column":805}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":57,"column":42},"generated":{"line":1,"column":807}},{"source":"js/audioSocket.js","name":"navigator","original":{"line":59,"column":4},"generated":{"line":1,"column":810}},{"source":"js/audioSocket.js","name":"mediaDevices","original":{"line":59,"column":14},"generated":{"line":1,"column":820}},{"source":"js/audioSocket.js","name":"getUserMedia","original":{"line":59,"column":27},"generated":{"line":1,"column":833}},{"source":"js/audioSocket.js","original":{"line":59,"column":40},"generated":{"line":1,"column":846}},{"source":"js/audioSocket.js","name":"audio","original":{"line":59,"column":41},"generated":{"line":1,"column":847}},{"source":"js/audioSocket.js","original":{"line":59,"column":48},"generated":{"line":1,"column":854}},{"source":"js/audioSocket.js","name":"video","original":{"line":59,"column":54},"generated":{"line":1,"column":856}},{"source":"js/audioSocket.js","original":{"line":59,"column":61},"generated":{"line":1,"column":863}},{"source":"js/audioSocket.js","name":"then","original":{"line":59,"column":69},"generated":{"line":1,"column":867}},{"source":"js/audioSocket.js","original":{"line":59,"column":74},"generated":{"line":1,"column":872}},{"source":"js/audioSocket.js","name":"stream","original":{"line":59,"column":74},"generated":{"line":1,"column":881}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":60,"column":12},"generated":{"line":1,"column":884}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":60,"column":12},"generated":{"line":1,"column":888}},{"source":"js/audioSocket.js","name":"stream","original":{"line":60,"column":26},"generated":{"line":1,"column":890}},{"source":"js/audioSocket.js","name":"console","original":{"line":61,"column":8},"generated":{"line":1,"column":892}},{"source":"js/audioSocket.js","name":"log","original":{"line":61,"column":16},"generated":{"line":1,"column":900}},{"source":"js/audioSocket.js","original":{"line":61,"column":20},"generated":{"line":1,"column":904}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":61,"column":29},"generated":{"line":1,"column":910}},{"source":"js/audioSocket.js","name":"peers","original":{"line":62,"column":8},"generated":{"line":1,"column":913}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":62,"column":14},"generated":{"line":1,"column":915}},{"source":"js/audioSocket.js","original":{"line":62,"column":27},"generated":{"line":1,"column":918}},{"source":"js/audioSocket.js","name":"SimplePeer","original":{"line":62,"column":31},"generated":{"line":1,"column":922}},{"source":"js/audioSocket.js","original":{"line":62,"column":42},"generated":{"line":1,"column":933}},{"source":"js/audioSocket.js","name":"initiator","original":{"line":63,"column":12},"generated":{"line":1,"column":934}},{"source":"js/audioSocket.js","name":"am_initiator","original":{"line":63,"column":23},"generated":{"line":1,"column":944}},{"source":"js/audioSocket.js","name":"stream","original":{"line":64,"column":12},"generated":{"line":1,"column":946}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":64,"column":20},"generated":{"line":1,"column":953}},{"source":"js/audioSocket.js","name":"config","original":{"line":65,"column":12},"generated":{"line":1,"column":955}},{"source":"js/audioSocket.js","name":"configuration","original":{"line":65,"column":20},"generated":{"line":1,"column":962}},{"source":"js/audioSocket.js","name":"peers","original":{"line":67,"column":8},"generated":{"line":1,"column":966}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":67,"column":14},"generated":{"line":1,"column":968}},{"source":"js/audioSocket.js","name":"on","original":{"line":67,"column":25},"generated":{"line":1,"column":971}},{"source":"js/audioSocket.js","original":{"line":67,"column":28},"generated":{"line":1,"column":974}},{"source":"js/audioSocket.js","original":{"line":67,"column":38},"generated":{"line":1,"column":983}},{"source":"js/audioSocket.js","name":"data","original":{"line":67,"column":38},"generated":{"line":1,"column":992}},{"source":"js/audioSocket.js","name":"socket","original":{"line":68,"column":12},"generated":{"line":1,"column":995}},{"source":"js/audioSocket.js","name":"emit","original":{"line":68,"column":19},"generated":{"line":1,"column":997}},{"source":"js/audioSocket.js","original":{"line":68,"column":24},"generated":{"line":1,"column":1002}},{"source":"js/audioSocket.js","original":{"line":68,"column":34},"generated":{"line":1,"column":1011}},{"source":"js/audioSocket.js","name":"signal","original":{"line":69,"column":16},"generated":{"line":1,"column":1012}},{"source":"js/audioSocket.js","name":"data","original":{"line":69,"column":24},"generated":{"line":1,"column":1019}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":70,"column":16},"generated":{"line":1,"column":1021}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":70,"column":27},"generated":{"line":1,"column":1031}},{"source":"js/audioSocket.js","name":"peers","original":{"line":74,"column":8},"generated":{"line":1,"column":1037}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":74,"column":14},"generated":{"line":1,"column":1039}},{"source":"js/audioSocket.js","name":"on","original":{"line":74,"column":25},"generated":{"line":1,"column":1042}},{"source":"js/audioSocket.js","original":{"line":74,"column":28},"generated":{"line":1,"column":1045}},{"source":"js/audioSocket.js","original":{"line":74,"column":38},"generated":{"line":1,"column":1054}},{"source":"js/audioSocket.js","name":"stream","original":{"line":74,"column":38},"generated":{"line":1,"column":1063}},{"source":"js/audioSocket.js","name":"console","original":{"line":75,"column":12},"generated":{"line":1,"column":1066}},{"source":"js/audioSocket.js","name":"log","original":{"line":75,"column":20},"generated":{"line":1,"column":1074}},{"source":"js/audioSocket.js","original":{"line":75,"column":24},"generated":{"line":1,"column":1078}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":76,"column":16},"generated":{"line":1,"column":1090}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":76,"column":16},"generated":{"line":1,"column":1094}},{"source":"js/audioSocket.js","name":"document","original":{"line":76,"column":25},"generated":{"line":1,"column":1096}},{"source":"js/audioSocket.js","name":"createElement","original":{"line":76,"column":34},"generated":{"line":1,"column":1105}},{"source":"js/audioSocket.js","original":{"line":76,"column":48},"generated":{"line":1,"column":1119}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":77,"column":12},"generated":{"line":1,"column":1128}},{"source":"js/audioSocket.js","name":"srcObject","original":{"line":77,"column":19},"generated":{"line":1,"column":1130}},{"source":"js/audioSocket.js","name":"stream","original":{"line":77,"column":31},"generated":{"line":1,"column":1140}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":78,"column":12},"generated":{"line":1,"column":1142}},{"source":"js/audioSocket.js","name":"id","original":{"line":78,"column":19},"generated":{"line":1,"column":1144}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":78,"column":24},"generated":{"line":1,"column":1147}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":79,"column":12},"generated":{"line":1,"column":1149}},{"source":"js/audioSocket.js","name":"playsinline","original":{"line":79,"column":19},"generated":{"line":1,"column":1151}},{"source":"js/audioSocket.js","original":{"line":79,"column":33},"generated":{"line":1,"column":1164}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":80,"column":12},"generated":{"line":1,"column":1166}},{"source":"js/audioSocket.js","name":"autoplay","original":{"line":80,"column":19},"generated":{"line":1,"column":1168}},{"source":"js/audioSocket.js","original":{"line":80,"column":30},"generated":{"line":1,"column":1178}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":81,"column":12},"generated":{"line":1,"column":1180}},{"source":"js/audioSocket.js","name":"className","original":{"line":81,"column":19},"generated":{"line":1,"column":1182}},{"source":"js/audioSocket.js","original":{"line":81,"column":31},"generated":{"line":1,"column":1192}},{"source":"js/audioSocket.js","name":"document","original":{"line":83,"column":12},"generated":{"line":1,"column":1198}},{"source":"js/audioSocket.js","name":"body","original":{"line":83,"column":21},"generated":{"line":1,"column":1207}},{"source":"js/audioSocket.js","name":"appendChild","original":{"line":83,"column":26},"generated":{"line":1,"column":1212}},{"source":"js/audioSocket.js","name":"newVid","original":{"line":83,"column":38},"generated":{"line":1,"column":1224}},{"source":"js/audioSocket.js","name":"window","original":{"line":96,"column":8},"generated":{"line":1,"column":1229}},{"source":"js/audioSocket.js","name":"toggleMute","original":{"line":96,"column":15},"generated":{"line":1,"column":1236}},{"source":"js/audioSocket.js","name":"toggleMute","original":{"line":88,"column":17},"generated":{"line":1,"column":1247}},{"source":"js/audioSocket.js","original":{"line":90,"column":17},"generated":{"line":1,"column":1258}},{"source":"js/audioSocket.js","original":{"line":90,"column":17},"generated":{"line":1,"column":1262}},{"source":"js/audioSocket.js","name":"index","original":{"line":90,"column":21},"generated":{"line":1,"column":1266}},{"source":"js/audioSocket.js","name":"console","original":{"line":89,"column":12},"generated":{"line":1,"column":1271}},{"source":"js/audioSocket.js","name":"log","original":{"line":89,"column":20},"generated":{"line":1,"column":1279}},{"source":"js/audioSocket.js","original":{"line":89,"column":24},"generated":{"line":1,"column":1283}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":90,"column":30},"generated":{"line":1,"column":1314}},{"source":"js/audioSocket.js","name":"getAudioTracks","original":{"line":90,"column":42},"generated":{"line":1,"column":1316}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":91,"column":16},"generated":{"line":1,"column":1333}},{"source":"js/audioSocket.js","name":"getAudioTracks","original":{"line":91,"column":28},"generated":{"line":1,"column":1335}},{"source":"js/audioSocket.js","name":"index","original":{"line":91,"column":45},"generated":{"line":1,"column":1352}},{"source":"js/audioSocket.js","name":"enabled","original":{"line":91,"column":52},"generated":{"line":1,"column":1355}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":91,"column":63},"generated":{"line":1,"column":1364}},{"source":"js/audioSocket.js","name":"getAudioTracks","original":{"line":91,"column":75},"generated":{"line":1,"column":1366}},{"source":"js/audioSocket.js","name":"index","original":{"line":91,"column":92},"generated":{"line":1,"column":1383}},{"source":"js/audioSocket.js","name":"enabled","original":{"line":91,"column":99},"generated":{"line":1,"column":1386}},{"source":"js/audioSocket.js","name":"muteButton","original":{"line":92,"column":16},"generated":{"line":1,"column":1394}},{"source":"js/audioSocket.js","name":"innerText","original":{"line":92,"column":27},"generated":{"line":1,"column":1405}},{"source":"js/audioSocket.js","name":"localStream","original":{"line":92,"column":39},"generated":{"line":1,"column":1415}},{"source":"js/audioSocket.js","name":"getAudioTracks","original":{"line":92,"column":51},"generated":{"line":1,"column":1417}},{"source":"js/audioSocket.js","name":"index","original":{"line":92,"column":68},"generated":{"line":1,"column":1434}},{"source":"js/audioSocket.js","name":"enabled","original":{"line":92,"column":75},"generated":{"line":1,"column":1437}},{"source":"js/audioSocket.js","original":{"line":92,"column":85},"generated":{"line":1,"column":1445}},{"source":"js/audioSocket.js","original":{"line":92,"column":97},"generated":{"line":1,"column":1455}},{"source":"js/audioSocket.js","original":{"line":105,"column":7},"generated":{"line":1,"column":1466}},{"source":"js/audioSocket.js","name":"removePeer","original":{"line":105,"column":16},"generated":{"line":1,"column":1475}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":105,"column":27},"generated":{"line":1,"column":1477}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":107,"column":8},"generated":{"line":1,"column":1480}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":107,"column":8},"generated":{"line":1,"column":1484}},{"source":"js/audioSocket.js","name":"document","original":{"line":107,"column":18},"generated":{"line":1,"column":1486}},{"source":"js/audioSocket.js","name":"getElementById","original":{"line":107,"column":27},"generated":{"line":1,"column":1495}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":107,"column":42},"generated":{"line":1,"column":1510}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":108,"column":8},"generated":{"line":1,"column":1513}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":110,"column":23},"generated":{"line":1,"column":1517}},{"source":"js/audioSocket.js","name":"srcObject","original":{"line":110,"column":31},"generated":{"line":1,"column":1519}},{"source":"js/audioSocket.js","name":"getTracks","original":{"line":110,"column":41},"generated":{"line":1,"column":1529}},{"source":"js/audioSocket.js","name":"forEach","original":{"line":112,"column":15},"generated":{"line":1,"column":1541}},{"source":"js/audioSocket.js","original":{"line":112,"column":23},"generated":{"line":1,"column":1549}},{"source":"js/audioSocket.js","name":"track","original":{"line":112,"column":33},"generated":{"line":1,"column":1558}},{"source":"js/audioSocket.js","name":"track","original":{"line":113,"column":12},"generated":{"line":1,"column":1561}},{"source":"js/audioSocket.js","name":"stop","original":{"line":113,"column":18},"generated":{"line":1,"column":1563}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":116,"column":8},"generated":{"line":1,"column":1572}},{"source":"js/audioSocket.js","name":"srcObject","original":{"line":116,"column":16},"generated":{"line":1,"column":1574}},{"source":"js/audioSocket.js","original":{"line":116,"column":28},"generated":{"line":1,"column":1584}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":117,"column":8},"generated":{"line":1,"column":1589}},{"source":"js/audioSocket.js","name":"parentNode","original":{"line":117,"column":16},"generated":{"line":1,"column":1591}},{"source":"js/audioSocket.js","name":"removeChild","original":{"line":117,"column":27},"generated":{"line":1,"column":1602}},{"source":"js/audioSocket.js","name":"videoEl","original":{"line":117,"column":39},"generated":{"line":1,"column":1614}},{"source":"js/audioSocket.js","name":"peers","original":{"line":119,"column":8},"generated":{"line":1,"column":1618}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":119,"column":14},"generated":{"line":1,"column":1620}},{"source":"js/audioSocket.js","name":"peers","original":{"line":119,"column":26},"generated":{"line":1,"column":1624}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":119,"column":32},"generated":{"line":1,"column":1626}},{"source":"js/audioSocket.js","name":"destroy","original":{"line":119,"column":43},"generated":{"line":1,"column":1629}},{"source":"js/audioSocket.js","name":"peers","original":{"line":120,"column":11},"generated":{"line":1,"column":1646}},{"source":"js/audioSocket.js","name":"socket_id","original":{"line":120,"column":17},"generated":{"line":1,"column":1648}}],"sources":{"js/audioSocket.js":"/**\n * RTCPeerConnection configuration \n */\n\n const configuration = {\n    // Using From https://www.metered.ca/tools/openrelay/\n    \"iceServers\": [\n    {\n      urls: \"stun:openrelay.metered.ca:80\"\n    },\n    {\n      urls: \"turn:openrelay.metered.ca:80\",\n      username: \"openrelayproject\",\n      credential: \"openrelayproject\"\n    },\n    {\n      urls: \"turn:openrelay.metered.ca:443\",\n      username: \"openrelayproject\",\n      credential: \"openrelayproject\"\n    },\n    {\n      urls: \"turn:openrelay.metered.ca:443?transport=tcp\",\n      username: \"openrelayproject\",\n      credential: \"openrelayproject\"\n    }\n  ]\n}\n\nvar peers;\nvar socket;\n// Initialize audio stream for socket\nexport function initiateAudio(_socket, _peers) {\n    peers = _peers;\n    socket = _socket;\n    socket.on('initReceive', socket_id => {\n        console.log('INIT RECEIVE ' + socket_id);\n        addPeer(socket_id, false)\n\n        socket.emit('initSend', socket_id)\n    })\n\n    socket.on('initSend', socket_id => {\n        console.log('INIT SEND ' + socket_id)\n        addPeer(socket_id, true)\n    })\n\n    socket.on('removePeer', socket_id => {\n        console.log('removing peer ' + socket_id)\n        removePeer(socket_id)\n    })\n\n    socket.on('signal', data => {\n        peers[data.socket_id].signal(data.signal)\n    })\n}\n\nfunction addPeer(socket_id, am_initiator, localStream) {\n\n    navigator.mediaDevices.getUserMedia({audio: true, video: false}).then(stream => {\n        let localStream = stream; \n        console.log('EOO'  + localStream);\n        peers[socket_id] = new SimplePeer({\n            initiator: am_initiator,\n            stream: localStream,\n            config: configuration\n        });\n        peers[socket_id].on('signal', data => {\n            socket.emit('signal', {\n                signal: data,\n                socket_id: socket_id\n            })\n        })\n    \n        peers[socket_id].on('stream', stream => {\n            console.log('Was here');\n            let newVid = document.createElement('video')\n            newVid.srcObject = stream\n            newVid.id = socket_id\n            newVid.playsinline = false\n            newVid.autoplay = true\n            newVid.className = \"vid\"\n            // append newVid to body\n            document.body.appendChild(newVid)\n        });\n        /**\n         * Enable/disable microphone\n         */\n        function toggleMute() {\n            console.log(\"Microphone has been toggled\");\n            for (let index in localStream.getAudioTracks()) {\n                localStream.getAudioTracks()[index].enabled = !localStream.getAudioTracks()[index].enabled\n                muteButton.innerText = localStream.getAudioTracks()[index].enabled ? \"Unmuted\" : \"Muted\"\n            }\n        }\n        \n        window.toggleMute = toggleMute;\n\n\n        \n    });\n    \n\n}\n\nexport function removePeer(socket_id) {\n\n    let videoEl = document.getElementById(socket_id)\n    if (videoEl) {\n\n        const tracks = videoEl.srcObject.getTracks();\n\n        tracks.forEach(function (track) {\n            track.stop()\n        })\n\n        videoEl.srcObject = null\n        videoEl.parentNode.removeChild(videoEl)\n    }\n    if (peers[socket_id]) peers[socket_id].destroy()\n    delete peers[socket_id]\n}"},"lineCount":null}},"error":null,"hash":"3f02efaf0b2c5885cabd1b53d490264f","cacheData":{"env":{}}}